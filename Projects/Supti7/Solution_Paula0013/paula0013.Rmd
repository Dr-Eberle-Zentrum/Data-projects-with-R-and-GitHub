
---
title: "paula0013"
output: md_document 
---

# Project 2: Comparison of salaries of global remote data scientists!

## Solution by paula0013
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(magrittr)
library(tidyverse)
library(countrycode)
library(rnaturalearth)
library(rnaturalearthdata)
library(sf)
```

Remote working became a norm during covid-19. And with remote work came more concern about salary. Letâ€™s see using the data from kaggle whether there is any difference in salary of remote data scientists in different countries.

# Read and transform of the data
```{r echo=FALSE, message=FALSE, warning=FALSE}
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# Read and transform the data
data <- readr::read_csv("../Salaries_data_scientists.csv") %>%
  filter(
    work_year == 2024,
    !is.na(remote_ratio),
    remote_ratio != "",
    !is.na(company_location),
    company_location != ""
  ) %>%
  mutate(job_title = fct_collapse(
    as_factor(job_title),  
    "Machine Learning Engineer" = c("ML Engineer", "Machine Learning Engineer"),
    "MLOps Engineer" = c("ML Ops Engineer", "MLOps Engineer", "Machine Learning Operations Engineer"),
    "Data Scientist" = c("Data Science", "Data Scientist", "Data Science Practitioner"),
    "Business Intelligence Analyst" = c("BI Analyst", "Business Intelligence Analyst"),
    "Business Intelligence Developer" = c("BI Developer", "Business Intelligence Developer"),
    "Business Intelligence Manager" = c("Business Intelligence Lead", "Business Intelligence Manager"),
    "AI Researcher" = c("AI Scientist", "AI Research Scientist", "AI Research Engineer"),
    "ETL Engineer" = c("ETL Developer", "ETL Engineer"),
    "Data Analytics Specialist" = c("Data Analytics Consultant", "Data Analytics Lead", "Data Analytics Manager", "Data Analytics Specialist"),
    "Head of Data" = c("Head of Data", "Data Lead", "Data Manager"),
    "Director of Data Science" = c("Director of Data Science", "Managing Director Data Science")
  ))

# Output
knitr::kable(head(data, 5)) 
```

# Visualisation of the percentage of the remote work ratio in comparsion to other countries 
This map shows the share of fully remote jobs (100% remote) compared to the total number of jobs per country for the year 2024. Countries without relevant data are shown in gray.
```{r echo=FALSE, message=FALSE, warning=FALSE}

# Percentage of remote working in comparison to the total jobs in the country 
remote_share <- data %>%
  group_by(company_location) %>%
  summarise(
    jobs_per_location = n(),
    remote_100 = sum(remote_ratio == 100),
    procent_100_remote = (remote_100 / jobs_per_location) * 100
  ) %>%
  filter(procent_100_remote > 0) %>%
  arrange(desc(procent_100_remote))

#Connection of the world map with the Percentage of remote working in comparsion to the total jobs in a country
country_remote <- ne_countries(scale = "medium", returnclass = "sf") %>%
  left_join(remote_share, by = c("iso_a2" = "company_location"))

# Produce of the text lable 
country_remote <- country_remote %>%
  mutate(
    label = ifelse(!is.na(procent_100_remote),
                   paste0(iso_a2, " ", round(procent_100_remote, 1), "%"),
                   NA)
  )

# Plot of the Percentage of remote working in comparison to the total jobs in country, in a world map
p1 <- ggplot(country_remote) +
  geom_sf(aes(fill = procent_100_remote), color = "white", size = 0.1) +
  geom_sf(data = subset(country_remote, !is.na(procent_100_remote)),
          fill = NA, color = "black", size = 0.4) +
  scale_fill_gradientn(
    name = "Share of all 100% remote jobs per country",
    colours = c("#bdd7e7", "#6baed6", "#2171b5", "#f03b20"),
    values = scales::rescale(c(0, 5, 15, 30)),
    na.value = "gray90",
    labels = function(x) paste0(round(x, 1), "%"),
    guide = guide_colorbar(title.position = "top")
  ) +
  geom_sf_text(
    aes(label = label),
    size = 2, color = "black", check_overlap = TRUE
  ) +
  labs(
    title = "Proportion of 100% Remote Jobs per Country (Share of Global Total)"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.direction = "horizontal",
    legend.title.align = 0.5,
    plot.title = element_text(hjust = 0.5, size = 18)
  )

# Save of the plot 1 
ggsave("plot_procent_remote_Work_Worlwide.png", p1, width = 15, height = 10)

``` 
![](plot_procent_remote_Work_Worlwide.png)

# Visualisation of average salary of the top 5 entry and mid-level jobs
This chart shows the average salaries of the five most common job titles at entry and mid-level. The error bars show the standard deviation within the respective group.
```{r, echo=FALSE, message=FALSE, warning=FALSE}

#Filter the data according to the top 5 jobs 
top5_jobs <- data %>%
  filter(experience_level %in% c("EN", "MI")) %>%
  count(job_title, sort = TRUE) %>%
  slice_max(n, n = 5) %>%
  pull(job_title)

#The salary of the top 5 entry and mid-level jobs
avg_salary <- data %>%
  filter(experience_level %in% c("EN", "MI"),
         job_title %in% top5_jobs) %>%
  group_by(job_title, experience_level) %>%
  summarise(
    avg_salary = mean(salary_in_usd, na.rm = TRUE),
    sd_salary = sd(salary_in_usd, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  mutate(experience_level = recode(experience_level,
                                   EN = "Entry Level",
                                   MI = "Mid Level"))
# Plot of the top 5 jobs and there salary in the entry and mid-level
p2 <- ggplot(avg_salary, aes(x = reorder(job_title, avg_salary), y = avg_salary, fill = experience_level)) +
  geom_col(position = position_dodge(width = 0.9), width = 0.7) +
  geom_errorbar(
    aes(ymin = avg_salary - sd_salary, ymax = avg_salary + sd_salary),
    position = position_dodge(width = 0.9),
    width = 0.25,
    color = "black"
  ) +
  coord_flip() +
  labs(
    title = "Average Salary of Top 5 Jobs by Experience Level (Entry & Mid)",
    x = "Job Title",
    y = "Average Salary (USD)",
    fill = "Experience Level"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 18)
  ) +
  scale_fill_manual(values = c("Entry Level" = "#1f78b4", "Mid Level" = "#33a02c"))


# Save the plot
ggsave("plot_top_5_jobs_Average_Salary.png", p2, width=15, height=10)

```
![](plot_top_5_jobs_Average_Salary.png)
