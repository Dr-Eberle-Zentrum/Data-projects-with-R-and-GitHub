---
title: "thomaskleiser"
author: "thomaskleiser"
output: "html_document"

---


```{r data_importation_manipulation_and_calculation, results = 'hide'}
# Solution attempt for Eric's Project by Thomas

library(readxl)
library(tidyverse)

# importing the data using read_xcel()
corona_eu <- read_xlsx("C:/Users/thoma/Documents/R/data.xlsx") %>%
  rename("country" = "countriesAndTerritories",
         "population_2020" = "popData2020") %>%
  na.omit()

# filtering for EU-countries with filter()

corona_eu <- corona_eu %>% 
  filter(country != "Norway" & country != "Iceland" & country != "Liechtenstein") %>%
# calculating the number of cases and deaths per country with group_by() and mutate()
  group_by(country) %>%
  summarize(cases_total = sum(cases),
            deaths_total = sum(deaths),
            cases_total_per_capita = cases_total / population_2020 * 100,
            deaths_total_per_capita = deaths_total / population_2020 * 1000,
            )
# calculating the mean number of cases and deaths per capita:
mean_cases_total_per_capita <- mean(corona_eu$cases_total_per_capita) * 1000

mean_deaths_total_per_capita <- mean(corona_eu$deaths_total_per_capita) * 1000

```



```{r visualization_of_cases}
# visualiszing the number of cases with ggplot() and geom_bar()
ggplot(corona_eu, aes(x = reorder(country, desc(cases_total_per_capita)), y = cases_total_per_capita)) +
  geom_bar(stat = "identity", fill = "lightblue") +
  geom_hline(yintercept = mean_cases_total_per_capita, linetype = "dotted") +
  geom_text(x = "Malta", y = 45, label = "EU average") +
  labs(title = "Number of reported Sars-CoV-2 Cases per 100 Inhabitants in EU, 2020-2022",
       caption = "Source: European Center for Disease Prevention and Control",
       x = element_blank(),
       y = element_blank()) +
  theme_classic() +
  theme(axis.text = element_text(angle = 90))

```

```{r visualization_of_deaths}
# visualizing the number of deaths with ggplot() and geom_bar()
ggplot(corona_eu, aes(x = reorder(country, desc(deaths_total_per_capita)), y = deaths_total_per_capita)) +
  geom_bar(stat = "identity", fill = "lightgreen") +
  geom_hline(yintercept = mean_deaths_total_per_capita, linetype = "dotted") +
  geom_text(x = "Malta", y = 3.25, label = "EU average") +
  labs(title = "Number of reported Deaths due to Sars-CoV-2 per 1000 Inhabitants in EU, 2020-2022",
       x = element_blank(),
       y = element_blank(),
       caption = "Sources: European Center for Disease Prevention and Control") +
  theme_classic() +
  theme(axis.text = element_text(angle = 90))
```

```{r cases_vs_bip}

bip_eu <- data.frame("country" = c("Luxembourg","Ireland","Norway","Denmark","Sweden",
                                   "Netherlands","Finland","Austria","Belgium","Germany",
                                   "France","Italy","Malta","Zyprus","spain",
                                   "Slowenia","Estonia","Czechia","Portugal","Lithuania"
                                   ,"Slovakia","Latvia","Greece","Hungary","Poland",
                                   "Croatia","Rumania","Bulgaria"),
                     "bip" = c(114370,84940,75360,57520,51630,
                               48840,45370,44970,43680,43290,
                               36660,30040,28220,26030,25460,
                               24680,23060,22270,20530,19760,
                               17820,17450,17140,15870,15050,
                               14701,12501,9850)
                     )

corona_bip_eu <- left_join(corona_eu,bip_eu, by = "country")

```

```{r visualisation_of_cases_vs_bip}

ggplot( corona_bip_eu, aes(x = unique(bip), y = unique(cases_total_per_capita)) ) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "Relation between Sars-CoV-2 cases and GDP",
       subtitel = "measeured in reported cases per capita and GDP per capita",
       caption = "Source: European Center for Disease Prevention and Control, Statista") +
  theme_classic()

```


```{r visualisation_of_deaths_vs_bip}

ggplot(corona_bip_eu, aes(x = bip, y = deaths_total_per_capita)) +
  geom_point() +
  geom_smooth(method = "lm") +
    labs(title = "Relation between Sars-CoV-2 deahts and GDP",
       subtitel = "measeured in reported deaths due to  Sars_CoV-2 cases per capita and GDP per capita",
       caption = "Source: European Center for Disease Prevention and Control, Statista")
  theme_calssic()

```
