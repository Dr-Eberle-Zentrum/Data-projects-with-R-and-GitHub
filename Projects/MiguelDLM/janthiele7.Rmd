---
title: "janthiele7_solution_for_miguel"
output: md_document
---

```{r}
#load packages
library(tidyverse)
library(dplyr)
```

#### Reading data
```{r}
#defining function to read the data
process_data <- function(file_path) {
  data <- read.csv(file_path)
}
```



"According to Marcé-Nogué et al. (2011), Finite Elements results may present singularities at the contact and constraint points, for this reason many researchers choose to remove the 1 or 2% higher stress values of the dataset."

So we will remove the top 2 % of the Misses Stress Measurement as a part of prepocessing. For that we will design a function.
```{r}
filter_extreme_values <- function(data, top_percent = 2) {
  cutoff <- quantile(data$Von.Misses.Stress, probs = 1 - top_percent / 100)
  filtered_data <- data %>% filter(Von.Misses.Stress <= cutoff)
  return(filtered_data)
}
```


####Segmenting data 

function that segments the data into 10 equal parts 
```{r}
segment_data <- function(data, axis, segments = 10) {
    min_val <- min(data[[axis]], na.rm = TRUE)
    max_val <- max(data[[axis]], na.rm = TRUE)
    segment_length <- (max_val - min_val) / segments
    
    breaks <- seq(min_val, max_val, by = segment_length)
    labels <- 1:segments
    
    data <- data %>%
      mutate(segment = cut(data[[axis]], breaks = breaks, labels = labels, include.lowest = TRUE, right = FALSE))
    
    return(data)
  }
```

segmenting all datasets into 10 equal parts along their axis
```{r}

```


####Calculating averages

Defining function to calculate average stress along the 10 segments 
```{r}
average_stress_by_segment <- function(segmented_data) {
    averaged_data <- segmented_data %>%
      group_by(segment) %>%
      summarise(avg_stress = mean(Von_Mises_Stress, na.rm = TRUE))
    
    return(averaged_data)
  }
```

#### Plotting 

Define plot function
```{r}
plot_avg_stress <- function(averaged_data, axis, animal_name) {
    ggplot(averaged_data, aes(x = as.numeric(as.character(segment)), y = avg_stress, group = animal_name)) +
      geom_line() +
      labs(title = paste("Average Stress Distribution along", axis, "Axis"),
           x = paste(axis, "Segments"),
           y = "Average Von Misses Stress",
           color = "Animal") +
      theme_minimal() +
      theme(legend.position = "top")
  }
```

