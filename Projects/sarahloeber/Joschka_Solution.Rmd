---
title: "Joschka's Solution to Sarah's Project"
author: "Joschka Christ"
date: "2024-06-29"
output: md_document
---

```{r}
library(tidyverse)
library(dplyr)
library(readr)

dataset_fluency_features <- read.csv("dataset_fluency_features.csv")
dataset_total_score <- read.csv("dataset_total_score.csv")

dataset_fluency_features_agg <- dataset_fluency_features %>%
  distinct() %>%
  mutate(articulationrate  = str_replace_all(articulationrate, ",", ".") %>%
           as.numeric(articulationrate)) %>%
  mutate(npause = as.numeric(npause)) %>%
  mutate(test_component_id = as.numeric(test_component_id)) %>%
aggregate(cbind(articulationrate, npause, test_component_id) ~ user_id, FUN = mean)

Full_Data <- left_join(dataset_fluency_features_agg, dataset_total_score, by = "user_id") # Left join b/c 4 user_ids missing in total score dataset

ggplot(Full_Data, aes(x = articulationrate, y = final_score, color = factor(test_component_id))) +
  geom_point() +
    geom_smooth(method = "lm", se = FALSE, color = "black") +
  facet_wrap(~ test_component_id, nrow = 1) +
  labs(
    title = "Scatterplot of Articulation Rate vs. Number of Pauses by Test Group",
    x = "Avg. Articulation Rate",
    y = "Final Score"
  ) +
  scale_color_manual(
    name = "Testing Group",
    values = c("red", "blue", "green", "orange", "purple"),
    labels = c("Group 1", "Group 2", "Group 3", "Group 4", "Group 5")
  ) +
  theme_minimal()

ggplot(Full_Data, aes(x = final_score, y = npause, color = factor(test_component_id))) +
  geom_point() +
    geom_smooth(method = "lm", se = FALSE, color = "black") +
  facet_wrap(~ test_component_id, nrow = 1) +
  labs(
    title = "Scatterplot of Final Test Score vs. Number of Pauses by Test Group",
    x = "Avg. Number of Pauses",
    y = "Final Test Score"
  ) +
    scale_color_manual(
    name = "Testing Group",
    values = c("red", "blue", "green", "orange", "purple"),
    labels = c("Group 1", "Group 2", "Group 3", "Group 4", "Group 5")
  ) +
  theme_minimal()

ggplot(Full_Data, aes(x = final_score, y = articulationrate, color = factor(test_component_id))) +
  geom_density_2d() +  # Create 2D density plot
    facet_wrap(~ test_component_id, nrow = 2) +
  labs(
    title = "2D Density Plot of Final Test Score vs. Avg. Articulation Rate by Test Group",
    x = "Final Score",
    y = "Avg. Articulation Rate",
    color = "Test Group"
  ) +
    scale_color_manual(
    name = "Testing Group",
    values = c("red", "blue", "green", "orange", "purple"),
    labels = c("Group 1", "Group 2", "Group 3", "Group 4", "Group 5")
  ) +
  theme_minimal()

ggplot(Full_Data, aes(x = final_score, y = npause, color = factor(test_component_id))) +
  geom_density_2d() +  # Create 2D density plot
    facet_wrap(~ test_component_id, nrow = 2) +
  labs(
    title = "2D Density Plot of Final Scores vs. Number of Pauses by Test Group",
    x = "Final Test Score",
    y = "Avg. Number of Pauses",
    color = "Test Group"
  ) +
    scale_color_manual(
    name = "Testing Group",
    values = c("red", "blue", "green", "orange", "purple"),
    labels = c("Group 1", "Group 2", "Group 3", "Group 4", "Group 5")
  ) +
  theme_minimal()
```
