---
title: "Untitled"
author: "Winterstetter, Alexander"
date: "`r Sys.Date()`"
output: md_document
---

```{r}
# Project Daniel
library(tidyverse)
library(assertr)
library(tm)
library(SnowballC)
library(qdap)
library(stopwords)
library(foreign)

herzog_data <- read.csv(file = "herzog.csv")
herzog_data$German.words <- as.character(herzog_data$German.words)
herzog_data_words <- data.frame(herzog_data$German.words)

single_string <- paste(herzog_data_words, sep = ",") |>
  str_replace_all('[",]', '') |>
  str_replace_all("\\s{2,}"," ")

single_string_count <- single_string |> VectorSource() |> VCorpus() |> tm_map(removePunctuation) |>
  tm_map(removeNumbers) |> tm_map(stripWhitespace) |>
  tm_map(removeWords, stopwords("de")) |>
  tm_map(removeWords, c("quot", "die", "ich", "sie", "mehr", "das", "heute", "es", "immer", "müssen")) |>
  tm_map(removeWords, c("und", "muß", "in", "gerade", "wenn", "auch", "viele", "deshalb", "gibt", "geht")) |>
  tm_map(removeWords, c("in", "ja", "der"))

single_string_count <- single_string_count |> freq_terms(10000) |> 
  arrange(desc(FREQ)) |> top_n(n = 75) 

  ggplot(single_string_count, aes(y = reorder(WORD, FREQ), x = FREQ)) + geom_col() +
  labs(y = "Word", x = "Word Frequency") + geom_vline(aes(xintercept = 0)) + theme_bw() + 
  ggtitle("Word Frequency of Roman Herzog speeches")
```