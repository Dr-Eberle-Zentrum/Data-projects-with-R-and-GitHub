---
title: "Untitled"
author: "Winterstetter, Alexander"
date: "`r Sys.Date()`"
output: md_document
---

```{r}
# Project Daniel
library(tidyverse)
library(assertr)
library(tm)
library(SnowballC)
library(qdap)
library(stopwords)
library(foreign)

herzog_data <- read.csv(file = "herzog.csv")
herzog_data$German.words <- as.character(herzog_data$German.words)
herzog_data_words <- data.frame(herzog_data$German.words)

single_string <- paste(herzog_data_words, sep = ",") |>
  str_replace_all('[",]', '') |>
  str_replace_all("\\s{2,}"," ")

freq_words <- paste0(c("quot", "die", "ich", "sie", "mehr", "das", "heute", "es", "immer", "mÃ¼ssen"))

freq <- str_c(freq_words, sep = "", collapse = " ")

single_string_corpus <- single_string |>
  str_replace_all("^(0|[1-9][0-9]*)$", '') |>
  str_replace_all(stopwords("de"), '') |>
  str_replace_all(freq,'')

freq_terms(single_string_corpus, 10000) |> arrange( desc(FREQ)) |> top_n( n = 25) |> 
  ggplot(aes(x = reorder(WORD, desc(FREQ)), y = FREQ)) + geom_col() +
  labs(x = "Word", y = "Word Frequency") + geom_hline(aes(yintercept = 0)) + theme_bw() + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  ggtitle("Word Frequency of Roman Herzog speeches")


```