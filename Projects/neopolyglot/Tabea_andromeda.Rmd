---
title: "Andromeda"
output: md_document
date: "2023-06-05"
---

```{r setup, echo=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(ggplot2)
library(dplyr)
install.packages("ggpubr", repos = "http://cran.us.r-project.org")
library(ggpubr)
library(readr)
library(jpeg)
library(tidyverse)

backgroundImage <- readJPEG("Andromeda_Galaxy.jpg")

Data <- read_csv("0224.dat", comment = "#", col_names = F) |> 
  separate(X1, into=c("R","V"), sep="\\s+", convert=T) |> 
  mutate( row = row_number(),
          ascending = row <= row[V == max(V)][[1]],
          R.ly= R *3261.56) 

ggplot(Data, aes(x= R.ly ,y= V, color = ascending))+
  background_image(backgroundImage)+
  geom_line()+
  geom_label(x=10000, y=270, label="ascending", color = "black", size=3, family="Arial", fill="lightblue") +
  geom_label(x=75000, y=270, label="remaining", color="black", size=3, family = "Arial", fill="orange")+
  theme(legend.position = element_blank()) +
  xlab("Distance (light years)") +
  ylab(expression("Velocity (km s"^"-1)"))+
  scale_x_continuous(breaks = c(25000, 50000, 75000, 100000), 
                     labels = c(25000, 50000, 75000, 100000))+
  scale_y_continuous(breaks = c(100,200),
                     labels = c(100,200))+
  theme_classic()

```
