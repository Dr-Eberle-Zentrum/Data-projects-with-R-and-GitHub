---
title: "Untitled"
author: "ManCao"
date: "2023-03-29"
output: md_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```
```{r}
knitr::opts_chunk$set(echo = FALSE)
#packages
library(tidyverse)
library(dplyr)
library(ggplot2)
library(lattice)

#work directory
getwd()
setwd("D:/WiSe2022-23/R2Course/Advanced-data-processing-with-R/Projects/elizavetashch")

#import
dataRaw<-read.csv("Microplastic_Affect_Soil_Properties_and_Plant_Biomass.csv",header=TRUE,sep=',')

#clean data, add biomass
dataRaw$CO2[dataRaw$CO2 == ""] <- NA
drop_na(dataRaw, CO2,root,WSA)
dataRaw$CO2 <- as.numeric(dataRaw$CO2)
dataRaw$CO2<-round(dataRaw$CO2,2)
dataRaw$root <- as.numeric(dataRaw$root)
dataRaw$WSA<- gsub("(\\..*)\\.", "\\.", dataRaw$WSA)%>%
  as.numeric(gsub("\\.", "", dataRaw$WSA))


data<-dataRaw%>%
    na.omit(dataRaw)%>%
    filter(shape=="Films")%>%
    filter(str_detect(root,"^[0-9.]+$"))%>%
    mutate(biomass=root+shoot)

#plot
p1<-levelplot(biomass~ WSA*CO2,data = data, col.regions = colorRampPalette(c("pink", "blue")), main = "Biomass Levelplot")


p2<-ggplot(data,aes(x=WSA,y=CO2,fill=biomass))+
  geom_tile()+
  scale_fill_gradient(low = "pink", high = "darkgreen") +
  labs(x="WSA",y="CO2",fill="Biomass")+
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.background = element_rect(fill = NA))

```