---
title: "initialsolutioncars_Svenja"
author: "SvenjaPoerstel"
date: "2025-06-03"
output: md_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse) 
library(readr) 
library(dplyr)
library(ggplot2)
```

```{r}
# to make it work always work (
if (interactive()) {
  setwd(dirname(rstudioapi::getSourceEditorContext()$path))
} else if (!is.null(knitr::current_input())) {
  setwd(dirname(knitr::current_input()))
}
# read csv
car <- read_csv("Auto_data.csv", show_col_types = FALSE)
```

## Data preparation
```{r}
## 1: Ensure each variable has its own column and each observation its own row
# check structure and summary of the data set 

str(car)
summary(car)
glimpse(car)

# check if values are missing
colSums(is.na(car))

## 2: Convert categorical variables into factors with descriptive labels
car_edited <- car %>%
  #convert origin codes to labeled factor
  mutate(origin = factor(origin,
                         levels = c(1, 2, 3),
                         labels = c("USA", "Europe", "Japan")))
#transfer horsepower to numeric


## 3: Identify and report any duplicate rows in the dataset
(n_duplicates <- nrow(car[duplicated(car), ]))

## 4: Discuss whether duplicates are meaningful or should be removed.
## 5: Identify columns with missing values.
colSums(is.na(car))

## 6: Summarize the number and percentage of missing values.
missing_summary <- car%>%
  summarise_all(~sum(is.na(.))) %>%
  pivot_longer(everything(), names_to = "variable", values_to = "missing_count") %>%
  mutate(percent_missing = round((missing_count / nrow(car)) * 100, 2))

missing_summary

## 7: Decide how to handle the missing values (e.g., remove, impute, or analyze separately).
## 8: Create a new variable for the **power-to-weight ratio** and store it in a new column.

car <- car %>%
  mutate(power_to_weight = horsepower / weight)
```

## Data visualization 
# Scatterplot: relationship between mpg and horsepower
```{r}
ggplot(car, aes(x = horsepower, y = mpg)) +
  geom_point(alpha = 0.6, color = "blue") +
  geom_smooth(method = "lm", se = TRUE, color = "darkblue") +
  labs(title = "Relationship between MPG and Horsepower",
       x = "Horsepower (PS)",
       y = "Miles per Gallon (mpg)") +
  theme_minimal()
```

# Scatterplot: relationship between weight and acceleration
```{r}
ggplot(car, aes(x = weight, y = acceleration)) +
  geom_point(alpha = 0.6, color = "red") +
  geom_smooth(method = "lm", se = TRUE, color = "darkred") +
  labs(title = "Relationship between Weight and Acceleration",
       x = "Weight (lbs)",
       y = "Acceleration (0-60 mph in seconds)") +
  theme_minimal()
```

# trend analysis
```{r}
car_yearly <- car %>%
  group_by(year) %>%
  summarise(
    avg_mpg = mean(mpg, na.rm = TRUE),
    avg_hp = mean(horsepower, na.rm = TRUE),
    avg_acc = mean(acceleration, na.rm = TRUE)
  ) %>%                                          
  pivot_longer(
    cols      = starts_with("avg_"),             
    names_to  = "variable",                      
    values_to = "value"                           
  ) %>%                                           
  mutate(variable = recode(variable,
                           avg_mpg = "mpg",
                           avg_hp  = "horsepower",
                           avg_acc = "acceleration"))

ggplot(car_yearly, aes(x = year, y = value, color = variable)) +
  geom_line(linewidth = 1) +
  geom_smooth(method = "loess", se = FALSE, linetype = "dashed") +
  scale_color_manual(
    name   = "Variable",
    values = c(mpg = "blue", horsepower = "red", acceleration = "green")
  ) +
  labs(title = "Trend Analysis of Car Characteristics over Years",
       x = "Year",
       y = "Average Value") +
  theme_minimal()
```
# further data visualisation to answer your questions 
# origins that tend to have the most powerful/fastest cars 

```{r}
ggplot(car, aes(x = origin, y = horsepower, fill = origin)) +
  geom_boxplot() +
  labs(title = "Horsepower by Car Origin", y = "Horsepower") +
  theme_minimal()
```

# relationship between cylinders and acceleration

```{r}
ggplot(car, aes(x = factor(cylinders), y = acceleration)) +
  geom_jitter(width = 0.2, color = "steelblue", alpha = 0.7) +
  labs(title = "Acceleration by Number of Cylinders",
       x = "Cylinders", y = "Acceleration (sec)") +
  theme_minimal()
```

# fastest car for each model

```{r}
fastest_cars <- car %>%
  group_by(year) %>%
  slice_min(acceleration, with_ties = FALSE) %>%
  select(year, name, acceleration)
print(fastest_cars)
```

# origin that has the most fuel-efficient cars on average 

```{r}
car %>%
  group_by(origin) %>%
  summarise(avg_mpg = mean(mpg, na.rm = TRUE)) %>%
  ggplot(aes(x = origin, y = avg_mpg, fill = origin)) +
  geom_col() +
  labs(title = "Average Fuel Efficiency by Origin", y = "MPG") +
  theme_minimal()
```
## Results 

-Negative Relationship between MPG and horsepower:
the more horsepower, the lower the MGP
-Negative Relationship between weight and acceleration, heavier cars tend to take less time to 
accelerate, but the data is fluctuating
-> doesn't seem intuitive
-Acceleration is mostly stable over the time, there is a small increase in mpg over time. Horsepower decreased a lot 
-> the sharp drop in horsepower around 1980 is remarkable

-cars from the US have the highest horsepower 
-the more cylinder the lower the acceleration 
-the table shows for each year the fastest car (lowest acceleration)
-japan seems to have the most average fuel efficient cars 