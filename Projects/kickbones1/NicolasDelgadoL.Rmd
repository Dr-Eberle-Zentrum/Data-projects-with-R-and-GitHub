
---
title: "NicolasDelgadoL"
output: md_document
date: "2025-01-07"
---

```{r setup, include=FALSE}
#Setting up packages
#knitr::opts_chunk$set(echo = TRUE, root.dir = here::here())
options(repos = c(CRAN = "https://cloud.r-project.org/"))
library(dplyr)
library(ggplot2)
```


```{r setup2, include=FALSE}
# Set working directory to the current file's location
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
```

```{r load, include=FALSE}
## Data Loading
data <- read.csv("kaggle_dataset.csv")
```


```{r inspect, include=FALSE}
# Inspect the dataset
str(data)
head(data)
```
# Solution to Luis' Data Project by NicolÃ¡s

 The aim of this data project was to analyze and visualize mobile device usage
 patterns based on app usage time, device model, and demographic information.


```{r code1, include=FALSE}
# Convert app usage time to hours/day
data <- data %>%
  mutate(Screen.On.Time..hours.day. = App.Usage.Time..min.day. / 60)
```

```{r code2, include=FALSE}
# Compute median app usage time and number of users per device model
device_summary <- data %>%
  group_by(Device.Model) %>%
  summarise(
    MedianAppUsage = median(Screen.On.Time..hours.day.),
    TotalUsers = n()
  ) %>%
  arrange(desc(TotalUsers))
```

```{r code3, include=FALSE}
# Create age group categories for visualization
data <- data %>%
  mutate(AgeGroup = case_when(
    Age >= 20 & Age <= 29 ~ "20-29",
    Age >= 30 & Age <= 39 ~ "30-39",
    Age >= 40 & Age <= 49 ~ "40-49",
    Age >= 50 & Age <= 59 ~ "50-59",
    TRUE ~ "Other"
  ))
```

Violin Plot by Device Model and Gender

# Plot 1: App usage time by device model
```{r plot1, echo = FALSE}
# Create a violin plot with gender and age group differentiation
ggplot(data, aes(x = Device.Model, y = Screen.On.Time..hours.day., fill = Gender)) +
  geom_violin(alpha = 0.3, color = "black") +  # Transparent violins
  geom_jitter(aes(color = AgeGroup), size = 1, width = 0.2) +  # Add points for age groups
  scale_color_manual(values = c("gray", "green", "purple", "blue", "orange")) +  # Custom colors for age groups
  labs(
    title = "Mobile Device Usage for Different Models",
    subtitle = "Shown is the median app usage time for different \n mobile devices, differentiated by gender and age group",
    x = "",
    y = "Median App Usage Time (hours/day)",
    fill = "Gender",
    color = "Age Group"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    plot.title = element_text(size = 14, face = "bold"),
    plot.subtitle = element_text(size = 12)
  )
```


