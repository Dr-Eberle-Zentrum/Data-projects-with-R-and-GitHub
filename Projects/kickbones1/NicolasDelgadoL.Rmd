
---
title: "NicolasDelgadoL"
output: md_document
date: "2025-01-07"
---

```{r setup}
#knitr::opts_chunk$set(echo = TRUE, root.dir = here::here())
options(repos = c(CRAN = "https://cloud.r-project.org/"))
library(dplyr)
library(ggplot2)
```
## Data Loading

```{r setup2}
# Set working directory to the current file's location
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
```
# Load the dataset
```{r load}
data <- read.csv("kaggle_dataset.csv")
```

# Inspect the dataset
```{r inspect}
str(data)
head(data)
```

Data Manipulation
Convert app usage time from minutes/day to hours/day.
Compute median app usage time for each device model.
Calculate the number of users for each device model.


# Convert app usage time to hours/day
```{r code1}
data <- data %>%
  mutate(Screen.On.Time..hours.day. = App.Usage.Time..min.day. / 60)
```

# Compute median app usage time and number of users per device model
```{r code2}
device_summary <- data %>%
  group_by(Device.Model) %>%
  summarise(
    MedianAppUsage = median(Screen.On.Time..hours.day.),
    TotalUsers = n()
  ) %>%
  arrange(desc(TotalUsers))
```

# Create age group categories for visualization
```{r code3}
data <- data %>%
  mutate(AgeGroup = case_when(
    Age >= 20 & Age <= 29 ~ "20-29",
    Age >= 30 & Age <= 39 ~ "30-39",
    Age >= 40 & Age <= 49 ~ "40-49",
    Age >= 50 & Age <= 59 ~ "50-59",
    TRUE ~ "Other"
  ))
```

Violin Plot by Device Model and Gender

# Create a violin plot with gender and age group differentiation
```{r plot1}
ggplot(data, aes(x = Device.Model, y = Screen.On.Time..hours.day., fill = Gender)) +
  geom_violin(alpha = 0.3, color = "black") +  # Transparent violins
  geom_jitter(aes(color = AgeGroup), size = 1, width = 0.2) +  # Add points for age groups
  scale_color_manual(values = c("gray", "green", "purple", "blue", "orange")) +  # Custom colors for age groups
  labs(
    title = "Mobile Device Usage for Different Models",
    subtitle = "Shown is the median app usage time for different mobile devices, differentiated by gender and age group",
    x = "",
    y = "Median App Usage Time (hours/day)",
    fill = "Gender",
    color = "Age Group"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    plot.title = element_text(size = 14, face = "bold"),
    plot.subtitle = element_text(size = 12)
  )
```

Adding User Counts to the Plot
```{r plot2}
# Add user count annotations below the x-axis
device_summary <- device_summary %>%
  mutate(Label = paste(TotalUsers, "Users"))

ggplot(data, aes(x = Device.Model, y = Screen.On.Time..hours.day., fill = Gender)) +
  geom_violin(alpha = 0.3, color = "black") +
  geom_jitter(aes(color = AgeGroup), size = 1, width = 0.2) +
  scale_color_manual(values = c("gray", "green", "purple", "blue", "orange")) +
  geom_text(
    data = device_summary,
    aes(x = Device.Model, y = -0.5, label = Label),
    inherit.aes = FALSE,
    size = 3,
    color = "black"
  ) +
  labs(
    title = "Mobile Device Usage for Different Models",
    subtitle = "Shown is the median app usage time for different mobile devices, differentiated by gender and age group",
    x = "",
    y = "Median App Usage Time (hours/day)",
    fill = "Gender",
    color = "Age Group"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    plot.title = element_text(size = 14, face = "bold"),
    plot.subtitle = element_text(size = 12),
    plot.margin = margin(20, 20, 40, 20)
  )
```

Conclusion
This analysis highlights trends in app usage time across device models and demographic groups. Key findings include:

Median app usage time varies significantly by device model.
Gender and age groups show distinct usage patterns.
Further exploration could examine differences across operating systems, app categories, or user satisfaction.

---


