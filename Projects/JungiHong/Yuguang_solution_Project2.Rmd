---
output: md_document
---
# This is the initial solution

```{r data1, echo=TRUE, warning=FALSE, message=FALSE}
library(tidyverse)
library(readxl)
file <- "C:/Users/Yugua/Desktop/R2/Volleyball Passing- USA and TU.xlsx"
#I don't know why the url didn't work
#'file <- "https://dataverse.harvard.edu/api/access/datafile/:persistentId?persistentId=doi:10.7910/DVN/27560/SS9PFS"
```


```{r, echo=FALSE, warning=FALSE, message=FALSE}

data_for1 <- read_excel(file, sheet = "TU sort by pass score", range = "F2:J6") |>
  rename(won = "points won", 
         lost = "points lost", 
         won_rate = "side out pct on just that pass score", 
         pass_score = "pass score")|>
  select(pass_score, won, lost)|>
  pivot_longer(cols = c(won, lost),
               names_to = "result", 
               values_to = "count")|>
  mutate(pass_score = factor(pass_score, levels = unique(pass_score)))
```

# Visualization of chart one
```{r}
ggplot(data_for1, aes(x = pass_score, y = count, fill = result))+
  geom_bar(stat = "identity", position = "stack")+
  labs(
    title = "Attempts by Pass Score", 
    x = "pass score", 
    y = "attempts", 
    fill = "result"
  ) +
  scale_fill_manual(values = c("won" = "blue", "lost" = "red"),
                    labels = c("won", "lost"))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE}
data <- read_excel(file, sheet = "USA and TU", range = "F3:K14")|>
  na.omit()|>
  rename(points_won = "Points Won", 
         passing_points_won = "Passing Points.",
         Points_lost = "Points Lost",
         passing_points_lost = "Passing Points"
         )|>
  select(points_won, passing_points_won, Points_lost, passing_points_lost)

data_for2 <- bind_rows(
  data %>% select(points_won, passing_points_won) %>% rename(points = points_won, passing_points = passing_points_won) %>% mutate(type = "won"),
  data %>% select(Points_lost, passing_points_lost) %>% rename(points = Points_lost, passing_points = passing_points_lost) %>% mutate(type = "lost")
)
```

# Visualization for chart two
```{r}
ggplot(data_for2, aes(x = points, y = passing_points, color = type)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", se = FALSE, aes(group = type)) + 
  labs(
    title = "Passing Points vs Points Won and Lost",
    x = "Points",
    y = "Passing Points",
    color = "Result"
  )
```
