---
title: "NICOtin-macht-suechtig"
author: "Nico Afentoulidis"
date: "`r Sys.Date()`"
output: md_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
data <- (
  read.csv2("Data_Project1.csv") |> 
    mutate(Radius_tot_mean = as.numeric( str_c(Radius_tot_mean)),
))

summary(data$Taxa)
```

# Nicos solution on Tabeas project

###The first plot:
The exercise was: Scatterplot with the mean radius size of each sample in which only the samples with Radius_number 1 are considered. Differentiation between different taxa, colour gradient from smaller to larger diameter.

```{r First plot, echo = FALSE}
data |> 
  dplyr::filter(Radius_number==1) |> 
    ggplot(aes( y = Radius_tot_mean, 
                x = Taxa )) +
    geom_jitter( aes(
      shape = Taxa,
      color = Radius_tot_mean)) +
    theme_classic() +
    ylab(label = "Mean of all measurements") +
    scale_color_continuous(name="Mean of all measurements") +
    scale_shape_discrete(labels= c("NA's", "Indet", "Populus", "Salix"))
```


###The second plot:
Then I tried the next exercise: A barplot in which the number of samples with the different numbers of annual rings is shown.

```{r Second plot, echo = FALSE}
data |> 
  dplyr::filter(str_detect(data$Radius_number,"")) |>  
  group_by(ID) |> 
  summarise(amount_rings = max(Radius_number)) |> 
    ggplot() +
    geom_bar(aes(x=as.factor(amount_rings))) +
    theme_classic() +
    xlab(label = "Numbers of annual rings") +
    ylab(label = "Number of samples")
```


###The third plot:
Last exercise: Scatterplot with dependence of standard deviation on the mean value of the radius, differentiated by taxa, including for each taxa a linear trend line.

```{r Third plot, echo = FALSE, message=FALSE, warning=FALSE}
data |> 
  dplyr::filter(str_detect(data$Radius_number,"")) |>
  ggplot(aes(x= Radius_tot_mean,
             y= as.numeric(Radius_tot_sd))) +
  geom_point(aes(color = Taxa)) +
  stat_smooth(method = lm,
              aes (color = Taxa)) +
  xlab(label = "Mean value of the radius") +
  ylab(label = "Standard deviation") +
  theme_classic() +
  scale_color_discrete(labels= c("NA's", "Indet", "Populus", "Salix"))
```
