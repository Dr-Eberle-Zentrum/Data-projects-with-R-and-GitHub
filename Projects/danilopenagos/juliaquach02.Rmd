---
title: "A Visual Exploration of the Artistic Landscape in Colombia (1940-2018)"
author: "Julia Quach"
date: "2023-06-22"
output: html_document
always_allow_html: true
---

```{r setup, include=FALSE}
library(tidyverse)
library(ggplot2)
library(rio)
library(kableExtra)
library(cowplot)
df <- import_list("PG_BD_INVITACIONES_SM05-20-2021.xlsx", rbind = TRUE)

```

-------------------------------------------------------------------------------

# Motivation

-------------------------------------------------------------------------------


In this project, we would like to get an insight into the art scene in Colombia in the second half of the 20th century. For this, we observe and visualise the transformation of the art scene of Bogot치. In particular, we take a closer look at the relations between the artists and galleries at that time.

-------------------------------------------------------------------------------

# Aim

-------------------------------------------------------------------------------


To visualise the relations between artists, exposition and gallery, we opt for a Sankey diagram.


-------------------------------------------------------------------------------

# Data Wrangling

-------------------------------------------------------------------------------


The available data set is an xlsx.-file with eight sheets, each sheet representing one decade between 1940 and 2018. Each row represents one gallery and for the galleries, the columns represent information about the name of the gallery, the title, the inauguration data, the artists and many more. In this project, we will focus on the variables "Nombre, Galeria, Espacio", "Artistas", and "A침o de fecha de inauguracion", i.e., galleries, artists and years. If information about the gallery, artist or year is not available, we drop the whole row representing that gallery.

```{r data wrangling, echo=FALSE}
# Reducing the df to the relevant columns

data <- df %>% 
  subset( select = c("Nombre / Galeria / Espacio", "Artistas" ,"A침o de fecha de inauguracion (aaaa)")) %>% # Reducing the df to the relevant columns
  rename( c(galleries = "Nombre / Galeria / Espacio", artists = "Artistas", year = "A침o de fecha de inauguracion (aaaa)" ) ) %>%  # Renaming columns
  separate_rows( artists, sep = ", ") %>% # Splitting strings of artists and saving as new variable
  mutate( across( c( artists, galleries ), function(x){ iconv(x, to='ASCII//TRANSLIT') } ) ) %>%
  mutate( year = as.integer( str_extract( year, regex("^[0-9]{4}") ) ) ) %>%  # Cast year format
  #na.omit() %>% # remove all rows with NA entries 
  mutate( decade = year%/%10*10) # add decade information 

list <- c("2011-2012-2013", "marzo", "29", "n", "N/A", "NN", "S.I", "s.i.", "S.I/S.I/2009", "S/F")
for (i in list) {
  data$artists<-na_if(data$artists,i)
}

data<- data[complete.cases(data), ] 

# select und slice_head
# data %>% 
#     select( ) %>% 
#     slice_head() %>%
#     knitr::kable( )

knitr::kable( data[1:5,1:3], col.names = c("Galleries", "Artists", "Year"), caption = "Table 1: First five rows of our data set after reduction of our initial data set.") %>%
    kable_styling(c("bordered", "striped"), full_width = T)

```

We classify the galleries by their decade and group the data set by the artists and galleries. This allows to count how many times a gallery invited an artist.


```{r grouping, echo=FALSE}

data_w_count <- data %>%
  group_by(artists, galleries, decade) %>%
  count( artists ) %>% 
  ungroup()

knitr::kable( data[1:5,], col.names = c("Galleries", "Artists", "Decade", "Number of Invitations"), caption = "Table 2: First five rows of our data set after computing the decade and counting of invitations") %>%
    kable_styling(c("bordered", "striped"), full_width = T)

```

-------------------------------------------------------------------------------

# Visualisation

To avoid a cluttered visualisation, we choose a minimum number of invitations for the artists to be included in the Sankey diagram and a certain decade which we want to visualise.

```{r visualization_function, echo=FALSE}
library( networkD3 )

# function to create sankey diagram with filtering options for the minimum number
# of invitations and a chosenDecade
create_sankey <- function( data_w_count, minNumInvitations, chosenDecade){
  
  links <- filter( data_w_count, n > minNumInvitations ) %>% 
            filter( decade == chosenDecade) %>% 
            select( galleries, artists, n ) %>% 
            rename( source = galleries, target = artists, value = n) %>%
            as.data.frame()
    
    
  
  # links <- data.frame(
  #   source=x$galleries,
  #   target=x$artists,
  #   value=x$n
  # )
  
  nodes <- data.frame(
    name=c(as.character(links$source),
           as.character(links$target))|>unique()
  )
  
  links$IDsource <- match(links$source, nodes$name)-1
  links$IDtarget <- match(links$target, nodes$name)-1
  
  #Network
  sankey <- sankeyNetwork(Links = links, Nodes = nodes, 
                          Source = "IDsource", Target = "IDtarget",
                          Value = "value", NodeID = "name",
                          sinksRight = FALSE, width = 1000)
  return( sankey )
}

```

For the 1950s, we visualise the artists that were invited:

```{r visualization 1950s, echo=FALSE}

create_sankey( data_w_count, 1, "1950") 
```


For the 1960s, 1970s and 2010s, we visualise the artists that were invited more than five times:

```{r visualization 1960s and 1970s, echo=FALSE, warning = FALSE }

decades <- 1950 + 10*c(1:6)

minNumInvitations <- 5

create_sankey( data_w_count, 5, "1960")
create_sankey( data_w_count, 5, "1970")
create_sankey( data_w_count, 5, "1980")
create_sankey( data_w_count, 5, "1990")
create_sankey( data_w_count, 5, "2000")
create_sankey( data_w_count, 5, "2010")

```


In the 1980s and 1990s, the art scene was apparently particularly busy. Therefore, we visualise the artists that were invited ten times ore more:

```{r visualization 1980s and 2000s, echo=FALSE}

create_sankey( data_w_count, 10, "1980") 
create_sankey( data_w_count, 10, "1990") 
```


-------------------------------------------------------------------------------

# Findings

-------------------------------------------------------------------------------


Apparently, there was an increase of exhibitions and inivitations in the 1980s and 1990s.
