---
title: 'Project description'
output: md_document
---
```{r}
library(readr)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(readxl)
library(ggrepel)

data <- list()
for (n in 1:6) {
data [[n]] <- read_excel("Season1-6 (1).xlsx", sheet = str_c("Season",n)) %>%select("Episode", "Ratings", "Title")} 

file <- bind_rows(data[1:6]) %>%
  mutate (Season= str_c(str_sub(Episode,start=2,end=2))) %>%
  mutate (Show=str_c(str_sub(Episode,start=4,end=5))) %>%
  drop_na()

Highest<- file%>%group_by(Season)%>%slice_max(Ratings)
Lowest<- file%>%group_by(Season)%>%slice_min(Ratings)


plot <- ggplot(file, aes(x=Show, y=Ratings, group=Season, color=Season))+
  geom_line() +
  labs(colour = "Season", x="Episode") +
  geom_point (data = Highest, size=3, shape=21, fill="transparent") +
  geom_point (data = Lowest, size=3, shape=21, fill="transparent") +
  geom_label_repel(aes(label=Title),
                  data=Highest,
                   box.padding= 0.35, 
                   point.padding = 0.5,
                   nudge_y = 1, alpha = 0.8, size=2) +
  theme_classic() +
  scale_colour_brewer(palette = "Dark2")
                 



print(plot)
```
