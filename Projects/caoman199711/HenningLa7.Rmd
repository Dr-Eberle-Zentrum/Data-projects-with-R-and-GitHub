---
title: "Man's project: Final solution by Henning"
author: "Henning Lang"
date: "31 3 2023"
output: md_document
---
# Man's project: 2 Broke Girls
## *Final solution made by Henning*

**About 2 Broke Girls**

It is an American sitcom, which aired on CBS(Columbia Broadcasting System) from 2011 to 2017. It tells a story about two young women waitressing at a greasy spoon diner strike up an unlikely friendship in the hopes of launching a successful business - if only they can raise the cash. For more details see [this website.](https://www.imdb.com/title/tt1845307/.)

![](https://raw.githubusercontent.com/Dr-Eberle-Zentrum/Advanced-data-processing-with-R/main/Projects/caoman199711/Girls.png)


```{r, include=F}
# Cleaning
rm (list = ls())
cat ("\14")
graphics.off()

# Packages
if (!require(ggpubr)) install.packages("ggpubr")
library(ggpubr)
if (!require(tidyverse)) install.packages("tidyverse")
library(tidyverse)
if (!require(xlsx)) install.packages("xlsx")
library(xlsx)
if (!require(ggrepel)) install.packages("ggrepel")
library(ggrepel)

# Insert data 
setwd ("C:/Users/henni/OneDrive - bwedu/Dokumente/EBPP/Semester_5/Advanced R/Man's Projekt")

# Data to list
data <- list()

# Automatisches Einlesen aller Excel-Sheets
for (i in 1:6){
data[[i]] <- read.xlsx("Seasons.xlsx", sheetIndex = i)
}

# Liste zum Datensatz, unnötige Zeilen und Spalten entfernen, episode-Spalte in Episode und Season aufteilen
bind_rows(data) %>% 
  drop_na(Episode) %>% 
  select(Episode, Title, Ratings) %>% 
  separate(Episode, into = c("season", "episode"), sep = "-") -> df

df$season <- sub("0", "", df$season)

# Prepare Dataset
names (df) <- c("season","episode",  "title","ratings")
summary(df)
table (df$ratings) # Sieht gut aus

# data mit min und max
subset(df, ratings==max(ratings) | ratings==min(ratings)) -> a
```

**About the importance for Man**

The reason Man chose this TV sitcom as her project theme is that she has a lot of feelings for it. It accompanied her throughout high school and two years of her university life. In the days when she was struggling alone and her friends were not around, the two girls were the ones who made me understand that no one’s twenties are easy, everything is full of difficulties and uncertainties, we just hang in there and one day we will find a way out. She is glad that she got to see their lives, it brought her laughter and tears, told her more about New York and taught her a lot of inappropriate slang :D
Unfortunately, the sitcom didn’t last long, ending in its sixth season, before the next phase of my life. The story was hastily brought to a close by the writers. Although not that perfect, despite the criticism of its high start and low end, it doesn’t matter, **it is still the best sitcom by her side**, nothing can replace it. The girls’ story is continuing in my mind.

**About the project**

- plot should show the ratings of all episodes per season in one plot.
- the episodes with the best ratings are mentioned with their title
- combine everything in one beautiful and clear plot

**About dataset**

```{r, echo = F}
head(df)
```


**About the solution of the project

```{r, echo=F}
ggplot(df, aes(x=episode, y=ratings, group = season)) +
  geom_line(aes(color = season), linewidth = 1.3) +
  geom_point(aes(color = factor(season)), color = "blue", shape=21, fill="#69b3a2", size=2) +
  theme_minimal() +
  theme(panel.grid.major.y = element_blank(),
        panel.grid.minor.y = element_blank(),
        axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        legend.background = element_rect(fill = "white", colour = "black")) +
  scale_color_manual(values=c("lightslateblue", "lightblue1", "lightgoldenrod4", "mediumblue", "lightcyan3", "lightcyan4")) +
  xlab (" ") +
  ylab ("Ratings") + 
  ggtitle("Ratings of 2 Broke Girls",
          subtitle = "Ratings from The Nielson Company (2016)") +
  geom_label_repel(aes(label = a$title),
                   data = a,
                   box.padding   = 0.35, 
                   point.padding = 0.5,
                   segment.color = 'grey50',
                   size = 3, 
                   nudge_y = 0.1,
                   nudge_x = 6)
```
