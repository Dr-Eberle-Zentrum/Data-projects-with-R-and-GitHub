---
title: "solution"
output: md_document
date: "2025-01-05"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Load required libraries
library(tidyverse)
library(fmsb)

# Load and clean the whisky data
whisky_data <- read.csv2("Projects/felix-gogollok/whisky-statistics/Whisky.csv", sep = ";", stringsAsFactors = FALSE) %>%
  rename_with(~ gsub("\\.+$", "", .), everything()) %>%  # Remove trailing dots from column names
  filter(!is.na(Region) & Region != "")  # Remove rows with NA or empty Region

# Convert 'Punkte' to numeric
whisky_data$Punkte <- as.numeric(whisky_data$Punkte)

# Calculate the fraction of whiskies rated 80 or higher by region
region_fractions <- whisky_data %>%
  mutate(High_Rating = Punkte > 80) %>%  # Add flag for high ratings
  group_by(Region) %>%
  summarise(Fraction = mean(High_Rating, na.rm = TRUE), .groups = "drop")  # Calculate fraction per region

# Prepare data for the spider web chart
max_fraction <- 1  # Maximum value for normalization
min_fraction <- 0  # Minimum value for normalization

# Transform data for radarchart
chart_data <- region_fractions %>%
  pivot_wider(names_from = Region, values_from = Fraction)

# Add Max and Min rows as a dataframe
chart_data <- rbind(
  Max = rep(max_fraction, ncol(chart_data)),
  Min = rep(min_fraction, ncol(chart_data)),
  chart_data
) %>%
  as.data.frame()  # Convert to data.frame

# Generate the spider web chart
par(mar = c(0, 0, 2, 0))  # Set margins
radarchart(
  chart_data,
  axistype = 1,                # Set axis type
  pcol = "black",              # Line color
  pfcol = adjustcolor("blue", alpha.f = 0.5),  # Transparent fill color
  plwd = 2,                    # Line width
  cglcol = "blue",             # Grid line color
  cglty = 1,                   # Grid line type (solid)
  cglwd = 0.8,                 # Grid line width
  axislabcol = "blue",         # Axis label color
  caxislabels = seq(0, 1, 0.25),  # Axis labels
  vlcex = 1.0                  # Vertex label size
)

# Add a title
title("Fraction of Whiskies Rated 80 or Higher per Region", cex.main = 1.5)
