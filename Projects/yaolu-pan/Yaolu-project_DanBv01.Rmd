---
title: "Yaolu's Project (v.DanB)"
author: "Daniel Barrera"
date: "2023-06-06"
output: html_document
---
### Loading data and libraries
```{r setup}
knitr::opts_chunk$set(echo = TRUE)
pisa_reading <- read.csv("pisa_reading_16-05-2023.csv", header = TRUE, stringsAsFactors = FALSE)
library(tidyverse)
library(ggplot2)
df<- pisa_reading
colnames(df)
```


### Exploring the data

I thought column names were actually a little long to display in the data frame.
```{r}
#Shortening columns' names
names(df)[names(df) == "Journals.Magazines_st"] <- "St_Mags"
names(df)[names(df) == "Comics_st"] <- "St_Comix"
names(df)[names(df) == "Fiction..novels..short.stories..stories._st"] <- "St_Fiction"
names(df)[names(df) == "Nonfiction..history..biography..science..technology._st"] <- "St_NonFi"
names(df)[names(df) == "Daily.newspapers_st"] <- "St_Paper"
names(df)[names(df) == "Journals.Magazines_pa"] <- "Pa_Mags"
names(df)[names(df) == "Comics_pa"] <- "Pa_Comix"
names(df)[names(df) == "Fiction..novels..short.stories..stories._pa"] <- "Pa_Fiction"
names(df)[names(df) == "Nonfiction..history..biography..science..technology._pa"] <- "Pa_NonFi"
names(df)[names(df) == "Daily.newspapers_pa"] <- "Pa_Papers"

colnames(df)
head(df)
```


## Describing the data:
Ranked index (self-assessed?) survey:
"How often do you read this type of book?"
* 1 = Never or almost never
* 5 = Several times a week

The data is categorical: **Ordinal data or ordered factor**

### Preliminary questions about the data:
- NA in all columns, i.e. an empty row, means no observation?
- NA in parent columns means only student answered or they parents don't read?
- NA in student columns means means there isn't a student or the student doesn't read?
- NA in one column means they never read that type or should it be 1?
- Who answered the survey: students, parents, or both?

## Goal: 
The goal of this project is to visualize how often students and their parents read different types of book.
1. diagram for bar plots of different book types
2. grouped plots for students and parents

## Plan
1. Stat summary
2. Boxplots by column
3. Clean data: remove outliers and NA
4. Explore relations and correlations
5. Add aggregated column for student and parents

```{r}
#Removing NA values and replace them with 1
any(is.na(df))
df[is.na(df)] <- 1
any(is.na(df))
lengths(df)
```

* Looking at STUDENTS only
```{r}
df_st <- df[,(2:6)]
head(df_st)
boxplot(df_st)
```
* Looking at PARENTS only
```{r}
df_pa <- df[,(7:11)]
head(df_pa)
boxplot(df_pa)
```


### summary statistics
```{r}
df_all <- df[,2:11]
head(df_all)
boxplot(df_all)
str(df_all)
summary(df_all)
summary(df_st)
summary(df_pa)
```

### Plotting
```{r}
barplot(as.matrix(df_st), cex.axis=0.6, cex.names=0.6,
        xlab='Type of text', ylab='Count from 5451 obs')

barplot(as.matrix(df_pa), cex.axis=0.6, cex.names=0.6,
        xlab='Type of text', ylab='Count from 5451 obs')

barplot(as.matrix(df_all), cex.axis=0.6, cex.names=0.6,
        xlab='Type of text', ylab='Count from 5451 obs')
```


## Preliminary findings
* What students and parents read the most are newspapers
* The same tendency is evident in both groups
* As they read more papers, they read more
* magazines, nonfiction, fiction, then comics (in that order)

### Plotting type of book side by side
The next plot illustrates better student-parent comparison

* First we need to change the order of columns
```{r}
colnames(df_all)
col_order <- c(
                "St_Mags","Pa_Mags","St_Comix","Pa_Comix",
               "St_Fiction","Pa_Fiction","St_NonFi","Pa_NonFi",
               "St_Paper","Pa_Papers"      
              )
df_reord <- df_all[, col_order]
colnames(df_reord)
View(df_reord)
```

* Then we can plot
```{r}
barplot(as.matrix(df_reord), cex.axis=0.6, cex.names=0.6,
        xlab='Type of text', ylab='Count from 5451 obs')

type_sum <- colSums(df_reord)
type_sum
```

* Now, we change the value, from count to mean
```{r}
columns <- colnames(df_reord)
type_mean <- colMeans(df_reord)
columns <- names(type_mean)

df_p <- data.frame(columns,type_mean)
df_p
```
* Finally, we can plot
```{r}
barplot(type_mean, cex.axis=0.6, cex.names=0.6,
        xlab='Type of text', ylab='Average')
boxplot(df_reord)
```

--------------
### Data frame types by reader
The values are indicated by the mean, not count.
```{r}
students_mean <- colMeans(df_st)
parents_mean <- colMeans(df_pa)
students_mean
parents_mean

df_means <- data.frame("Mags" = c(students_mean[1],parents_mean[1]),
                "Comics" = c(students_mean[2],parents_mean[2]),
                "Fiction" = c(students_mean[3],parents_mean[3]),
                "Nonfiction" = c(students_mean[4],parents_mean[4]),
                "Newspapers" = c(students_mean[5],parents_mean[5])
                )
View(df_means)

barplot(as.matrix(df_means), cex.axis=0.6, cex.names=0.6,
        xlab='Type of text', ylab='Mean', 
        col = c("mistyrose", "lightcyan"), 
        legend.text = c("Students","Parents"))
```

## Final plot by types
I think the best way to display book types is to plot readers side by side
```{r}
barplot(as.matrix(df_means), cex.axis=0.6, cex.names=0.6,
        xlab='Type of text', ylab='Mean', 
        col = c("mistyrose", "lightcyan"),
        beside = TRUE, 
        legend.text = c("Students","Parents"))

```

